<div fxLayout="row">
  <div>
    <h2>Events</h2>
    <mat-list dense class="event-list">
      <mat-list-item *ngFor="let tournamentEvent of tournamentEvents" (click)="onSelectEvent(tournamentEvent)"
      [ngClass]="isSelected (tournamentEvent) ? 'selected' : 'not-selected'">
        {{tournamentEvent.name}}
      </mat-list-item>
    </mat-list>
  </div>
  <div fxFlex>
    <mat-toolbar>
      <mat-toolbar-row>
        <button type="button" color="primary" mat-raised-button (click)="generateDraw()" [disabled]="selectedEvent == null">
          <mat-icon matListIcon>assignment</mat-icon>Generate
        </button>
        <span class="toolbar-spacer-2"></span>
        <button type="button" mat-raised-button  (click)="clearDraw()" [disabled]="selectedEvent == null">
          <mat-icon matListIcon>clear</mat-icon>Clear Draw
        </button>
        <span class="toolbar-spacer-2"></span>
        <button type="button" mat-raised-button  (click)="showPlayoffDraw()" [disabled]="selectedEvent == null">
          <mat-icon matListIcon>line_style</mat-icon>Playoff Draw
        </button>
        <span fxFlex></span>
        <span *ngIf="selectedEvent" class="mat-h2">Draws for: {{selectedEvent?.name}}</span>
      </mat-toolbar-row>
    </mat-toolbar>
    <div class="draws-panel">
      <div fxLayout="row wrap"
        fxLayoutGap="32px"
        fxLayoutAlign="flex-start" cdkDropListGroup>
        <div *ngFor="let group of groups; let idx = index;">
          <table>
            <thead>
            <tr>
              <th>&nbsp;</th>
              <th class="group-num-column">
                Group: {{group.groupNum}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <!--                </th>-->
                <!--                <th>-->
                {{selectedEvent.startTime | startTime}}
              </th>
            </tr>
            </thead>
            <tbody cdkDropList
                   [id]="'groupTB' + (idx + 1)"
                   (cdkDropListDropped)="onDrawItemDrop($event)"
                   [cdkDropListData]="group.drawItems"
                   [cdkDropListSortPredicate]="canDropPredicate"
                   [cdkDropListEnterPredicate]="canMoveDrawItem">
            <tr *ngFor="let drawItem of group.drawItems;"
                cdkDrag
                cdkDragBoundary=".draws-panel"
                [cdkDragData]="drawItem"
                [cdkDragDisabled]="drawItem.placeInGroup === 1">
              <ng-container *ngIf="drawItem.rating >= 0; else fakeItem;">
                <td class="rating-column">{{drawItem.rating}}</td>
                <td class="player-column">
                  <div>{{drawItem.playerName}}</div>
                  <div class="additional-info">
                    {{drawItem.state ? drawItem.state : 'N/A'}}, {{drawItem.clubName ? drawItem.clubName : 'N/A'}}
                  </div>
                  <div *cdkDragPreview fxLayout="row" class="drag-preview">
                    <div fxFlex="17%">{{drawItem.rating}}</div>
                    <div fxFlex="83%">
                      <div>{{drawItem.playerName}}</div>
                      <div class="additional-info">
                        {{drawItem.state ? drawItem.state : 'N/A'}}, {{drawItem.clubName ? drawItem.clubName : 'N/A'}}
                      </div>
                    </div>
                  </div>
                </td>
              </ng-container>
              <ng-template #fakeItem>
                <td class="rating-column">&nbsp;</td>
                <td class="player-column">
                  <div>&nbsp;</div>
                  <div class="additional-info">&nbsp;</div>
                  <div *cdkDragPreview fxLayout="row" class="drag-preview">
                    <div fxFlex="17%">&nbsp;</div>
                    <div fxFlex="83%">
                      <div>&nbsp;</div>
                      <div class="additional-info">&nbsp;</div>
                    </div>
                  </div>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
