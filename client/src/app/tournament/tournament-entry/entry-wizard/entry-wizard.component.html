<div fxLayout="row">
  <div fxFlex></div>
  <div fxFlex.lt-md="100%" fxFlex="60%">
    <form name="form" (ngSubmit)="onSave(f.value)" #f="ngForm" novalidate>
      <input type="hidden" [ngModel]="entry?.id" name="id">
      <input type="hidden" [ngModel]="entry?.tournamentFk" name="tournamentFk">
      <mat-vertical-stepper linear>
        <mat-step label="Entry Type" *ngIf="!teamsTournament">
          <mat-radio-group [ngModel]="entry?.type" name="type" (change)="onChange(f.form)">
            <div fxLayout="column" fxLayoutGap="20px">
              <mat-radio-button *ngIf="!teamsTournament" value="0" [checked]="!teamsTournament">Individual</mat-radio-button>
              <mat-radio-button *ngIf="!teamsTournament" value="1" [checked]="!teamsTournament">Family</mat-radio-button>
              <mat-radio-button *ngIf="teamsTournament" value="2" [checked]="teamsTournament">Team</mat-radio-button>
            </div>
          </mat-radio-group>
          <div class="wizard-button-bar" fxLayout="row">
            <span fxFlex></span>
            <button mat-raised-button color="primary" matStepperNext type="button">Next</button>
          </div>
        </mat-step>
        <mat-step label="Group/Family Members" *ngIf="entry?.type == 1 || teamsTournament">
          Select member to enter/modify entry for
          <mat-toolbar>
            <mat-toolbar-row>
              <button type="button" mat-button (click)="addMember()">
                <mat-icon matListIcon>add</mat-icon>
                Add Member
              </button>
            </mat-toolbar-row>
          </mat-toolbar>
          <table mat-table [dataSource]="otherPlayersBS$ | async" style="width: 100%">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>First Name, Last Name</th>
              <td mat-cell *matCellDef="let player">{{player.firstName}} {{player.lastName}}</td>
            </ng-container>

            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Action</th>
              <td mat-cell *matCellDef="let player">
                <button type="button" mat-icon-button (click)="addMember()">
                  <mat-icon matListIcon>edit</mat-icon>
                </button>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
            <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay"></tr>
          </table>
          <div class="wizard-button-bar" fxLayout="row">
            <button mat-raised-button matStepperPrevious type="button">Back</button>
            <span fxFlex></span>
            <button mat-raised-button color="primary" matStepperNext type="button">Next</button>
          </div>
        </mat-step>
        <mat-step label="USATT Membership">
          <mat-radio-group [ngModel]="entry?.membershipOption" name="membershipOption" (change)="onChange(f.form)">
            <div fxLayout="column" fxLayoutGap="30px" *ngFor="let option of membershipOptions">
                <mat-radio-button [value]="option.value" style="padding-top: 10px">
                  {{option.label}} <span style="font-weight: bold">{{ (option.cost == 0) ? '' : option.cost | currency: 'USD'}}</span>
                </mat-radio-button>
            </div>
          </mat-radio-group>
          <div class="wizard-button-bar" fxLayout="row">
            <button mat-raised-button matStepperPrevious type="button">Back</button>
            <span fxFlex></span>
            <button mat-raised-button color="primary" matStepperNext type="button">Next</button>
          </div>
        </mat-step>
        <mat-step label="Events">
          <mat-list>
            <div class="mat-title">Entered Events</div>
            <mat-divider></mat-divider>
            <mat-list-item *ngFor="let enteredEvent of enteredEvents; last as last">
              <div mat-line>{{enteredEvent.event.name}} - ${{ enteredEvent.event.feeAdult }}</div>
              <div mat-line>{{ enteredEvent.event.day | eventDay: tournamentStartDate }} {{ enteredEvent.event.startTime | startTime }}</div>
              <div mat-line [class]="getStatusClass(enteredEvent.status)">{{enteredEvent.status | eventEntryStatus }}</div>
              <button type="button" mat-button (click)="onEventWithdraw(enteredEvent.eventEntryFk)">Drop</button>
              <mat-divider [inset]="true" *ngIf="!last"></mat-divider>
            </mat-list-item>
            <mat-divider></mat-divider>
            <div class="mat-title" style="padding-top: 10px">Events Available to Enter</div>
            <mat-divider></mat-divider>
            <mat-list-item *ngFor="let availableEvent of availableEvents; last as last2">
              <div mat-line>{{availableEvent.event.name}} - ${{ availableEvent.event.feeAdult }}</div>
              <div mat-line>{{ availableEvent.event.day | eventDay: tournamentStartDate }} {{ availableEvent.event.startTime | startTime }}</div>
              <div mat-line [class]="getStatusClass(availableEvent.status)">{{ availableEvent.status | eventEntryStatus }}</div>
              <button type="button" mat-button (click)="onEventEnter(availableEvent.event.id, availableEvent.eventEntryCommand)">Enter</button>
              <mat-divider [inset]="true" *ngIf="!last2"></mat-divider>
            </mat-list-item>
            <mat-divider></mat-divider>
            <div class="mat-title" style="padding-top: 10px">Events Not Available to Enter</div>
            <mat-divider></mat-divider>
            <mat-list-item *ngFor="let unavailableEvent of unavailableEvents; last as last3">
              <div mat-line>{{unavailableEvent.event.name}} - ${{ unavailableEvent.event.feeAdult }}</div>
              <div mat-line>{{ unavailableEvent.event.day | eventDay: tournamentStartDate }} {{ unavailableEvent.event.startTime | startTime }}</div>
              <div mat-line>{{unavailableEvent.availabilityStatus | availabilityStatus }}</div>
              <mat-divider [inset]="true" *ngIf="!last3"></mat-divider>
            </mat-list-item>
          </mat-list>
          <div class="wizard-button-bar" fxLayout="row">
            <button mat-raised-button matStepperPrevious type="button">Back</button>
            <span fxFlex></span>
            <button mat-raised-button color="primary" matStepperNext type="button">Next</button>
          </div>
        </mat-step>
        <mat-step label="Summary">
          <table style="width: 100%;">
            <tbody>
            <tr>
              <th style="width: 80%; text-align: left;">Events</th>
              <th style="width: 20%; text-align: right;">Price</th>
            </tr>
            <tr *ngFor="let enteredEvent of enteredEvents; last as last">
              <td style="width: 80%">
                {{ enteredEvent.event.name }}
                <h5>{{ enteredEvent.event.day | eventDay: tournamentStartDate }} {{ enteredEvent.event.startTime | startTime }}</h5>
<!--                <h5>{{enteredEvent.eventEntry.status | eventEntryStatus }}</h5>-->
              </td>
              <td style="width: 20%; text-align: right">
                ${{ enteredEvent.event.feeAdult }}
              </td>
            </tr>
            <tr>
              <th style="width: 80%; text-align: left;">Membership</th>
              <th style="width: 20%; text-align: right;"></th>
            </tr>
            <tr>
              <td style="width: 80%">
                {{ getMembershipLabel(entry?.id) }}
              </td>
              <td style="width: 20%; text-align: right">
                {{ getMembershipPrice(entry?.id) }}
              </td>
            </tr>
            </tbody>
            <tfoot>
            <tr>
              <td style="width: 80%"><h2>Player Total</h2></td>
              <td style="width: 20%; text-align: right;"><h2>{{ getPlayerTotal(entry?.id)}}</h2></td>
            </tr>
            </tfoot>
          </table>
          <div class="wizard-button-bar" fxLayout="row">
            <button mat-raised-button matStepperPrevious type="button">Back</button>
            <span fxFlex></span>
            <button mat-raised-button color="primary" matStepperNext type="button">Next</button>
          </div>
        </mat-step>
        <mat-step label="Payment/Refund">
          Pay or confirm refund issuance
          <button mat-raised-button color="primary" type="button" (click)="onPayPlayerTotal()">Pay {{ getPlayerTotal(entry?.id)}} Now</button>
          <div fxLayout="row">
            <button mat-raised-button matStepperPrevious type="button">Back</button>
            <span fxFlex></span>
            <button mat-raised-button color="primary" matStepperNext type="button">Next</button>
          </div>
        </mat-step>
        <mat-step label="Completed">
          Pay or confirm refund issuance
          <div class="wizard-button-bar" fxLayout="row">
            <button mat-raised-button matStepperPrevious type="button">Back</button>
            <span fxFlex></span>
            <button mat-raised-button color="primary" type="submit">Finish</button>
          </div>
        </mat-step>
      </mat-vertical-stepper>
    </form>
  </div>
  <div fxFlex></div>
</div>
